<div class="dashboard-container">

  <div class="dashboard-user-info">
    <img src="https://uxwing.com/wp-content/themes/uxwing/download/peoples-avatars/no-profile-picture-icon.png" alt="User Avatar" class="user-avatar">
    <div>
      <h2>Welcome <%= current_user.name %>!</h2>
      <p><strong>Email:</strong> <%= current_user.email %></p>
    </div>
    <button class="button-green">
      <a href="<%= new_island_path %>">Upload My Island</a>
    </button>
  </div>

  <%# DASHBOARD %>
  <div class="dashboard-cards">

    <div class="dashboard-card">
      <h2>My Islands</h2>

      <%# CAROUSEL - MY ISLANDS %>
      <div class="carousel-container">
        <div class="carousel-view">
          <button id="prev-btn" class="prev-btn">&#9664;</button>
          <div id="item-list" class="item-list">
            <% @islands.each do |island| %>
              <div class="card-item">
                <a href="<%= island_path(island) %>" class="card-link">
                  <img src="<%= island.image %>" alt="<%= island.name %>">
                  <h3><%= island.name %></h3>
                  <p><i class="fa-solid fa-location-dot"></i> <%= island.location %></p>
                </a>
              </div>
            <% end %>
          </div>
          <button id="next-btn" class="next-btn">&#9654;</button>
        </div>
      </div>
    </div>

    <div class="dashboard-card">
      <h2>My Bookings</h2>

      <%# CAROUSEL - MY BOOKINGS %>
      <div class="carousel-container">
        <div class="carousel-view">
          <button id="prev-btn" class="prev-btn">&#9664;</button>
          <div id="item-list" class="item-list">
            <% unless @user_bookings.empty? %>
              <% @user_bookings.each do |booking| %>
                <div class="card-item">
                  <h3>Booking ID: <%= booking.id %></h3>
                  <p>Island ID: <%= booking.island_id %></p>
                  <p>Number of Guests: <%= booking.number_of_guests %></p>
                  <p>Your island getaway at: <%= booking.island.name %>, <%= booking.island.location %> (<%= booking.number_of_guests %> guests)</p>
                  <p>Booking dates: <%= booking.start_date%>-<%= booking.end_date %> (<%= (booking.end_date - booking.start_date).to_i %> days)</p>
                  <% if booking.status == true %>
                  <p><strong>Booking status: Confirmed</strong></p>
                  <% elsif booking.status == false %>
                    <p><strong>Booking status: Declined</strong></p>
                  <% else %>
                    <p><strong>Booking status: Pending</strong></p>
                  <% end %>                  <p>Total Price: $<%= (booking.end_date - booking.start_date).to_i * booking.island.price %> ($<%= booking.island.price %>/day)</p>
                  <%= link_to "Delete", booking_path(booking), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"}, class: 'delete-btn' %>
                </div>
              <% end %>
            <% else %>
              <p>No bookings yet.</p>
            <% end %>
          </div>
          <button id="next-btn" class="next-btn">&#9654;</button>
        </div>
      </div>
    </div>

    <div class="dashboard-card">
      <h2>Bookings for My Islands</h2>
      <%# CAROUSEL - BOOKINGS FOR MY ISLANDS %>
      <div class="carousel-container">
        <div class="carousel-view">
          <button id="prev-btn" class="prev-btn">&#9664;</button>
          <div id="item-list" class="item-list">
            <% unless @bookings.empty? %>
              <% @bookings.each do |booking| %>
                <div class="card-item">
                  <h3>Booking: #<%= booking.id %></h3>
                  <p><%= booking.island.name %></p>
                  <p><%= booking.start_date%>-<%= booking.end_date %> (<%= (booking.end_date - booking.start_date).to_i %> days)</p>
                  <p>Number of Guests: <%= booking.number_of_guests %></p>
                 <% if booking.status == true %>
                  <p><strong>Booking status: Confirmed</strong></p>
                  <% elsif booking.status == false %>
                    <p><strong>Booking status: Declined</strong></p>
                  <% else %>
                    <p><strong>Booking status: Pending</strong></p>
                 <% end %>
                  <div class="booking-actions">
                    <%= link_to "Accept", booking_path(booking, status: true), data: { turbo_method: :patch }, class: "accept-link" %> |
                    <%= link_to "Decline", booking_path(booking, status: false), data: { turbo_method: :patch }, class: "decline-link" %>
                  </div>

                </div>
              <% end %>
            <% else %>
              <p>No bookings yet.</p>
            <% end %>
          </div>
          <button id="next-btn" class="next-btn">&#9654;</button>
        </div>
      </div>
    </div>
  </div>
</div>
